@page "/recipes/{RecipeId:int}"
@inject IDbContextFactory<ApplicationDbContext> DbFactory
@inject IRecipeService RecipeService

<RecipeComponent Recipe="@Recipe"></RecipeComponent>

@code {
    [Parameter]
    public int RecipeId { get; set; }

    public Recipe Recipe { get; set; } = new Recipe();

    protected override async Task OnParametersSetAsync()
    {
        //Recipe = new Recipe();
        //using (ApplicationDbContext context = DbFactory.CreateDbContext())
        //{
        //    Recipe recipe = new Recipe();
        //    recipe = await context.Recipes.Include(r=>r.Ingredients)
        //        .FirstAsync(r=>r.Id==RecipeId);
        //    Recipe = recipe ?? new Recipe(){Id = 0, Title = "No recipe found"};
        //}
        Recipe = await RecipeService.GetRecipeByIdAsync(RecipeId);
    }
}
